{% extends 'base_public.html' %} {% load static i18n thumbnail %} 

{% block navbar %}
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <div class="container-fluid">
    <a class="navbar-brand text-muted" href="{% url 'search:home' %}">
      <img src="{% static 'img/logo.jpg' %}" height="40" width="40" style="border-radius: 10%;" class="">
      <span class="text-white mt-2">{% trans 'BT - Backtesting' %}</span>   
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor01" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarColor01">
      <ul class="navbar-nav me-auto">
        <!-- <li class="nav-item">
          <a class="nav-link text-white" href="{% url 'zixuan:home' %}">{% trans '自选股' %}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="{% url 'investors:xuangu' %}">{% trans '条件选股' %}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="{% url 'stock_market:huice' %}">{% trans '策略模拟' %}</a>
        </li> -->
      </ul>
    </div>
    <div class="d-flex col-lg-4" id="searchForm" >
      <input type="text" class="form-control form-control-sm me-sm-2" id="searchText" autocomplete="off" name="q" placeholder="{% trans '股票名称, 代码或首字母' %}" value="{{search_single.ts_code}}">
      <input type="hidden" id="hiddenTscode" value="000001.SZ"/>
    </div>
    {% if request.user.is_authenticated %}
      <div class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          {% if request.user.picture %}
          <img src="/media/{{ request.user.picture }}" height="30" width="30" style="border-radius: 50%;" class="user-image">
          {% else %} 
          <img src="{% static 'img/user.png' %}" height="30" alt="{% trans '无个人头像' %}" />
          {% endif %}
          <span class="text-white">{{ request.user.name }}</span>
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="{% url 'user:get_profile' %}"><i class="fa fa-cogs fa-fw" aria-hidden="true"></i>&nbsp; {% trans '个人信息设置' %}</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="{%url 'account:logout'%}" id="logout"><i class="fa fa-sign-out-alt fa-fw" aria-hidden="true"></i>&nbsp; {% trans '注销' %}</a>
        </div>
      </div>
    {% else %}
    <!-- <a class="btn btn-primary" href="#">{% trans '快速登录' %}</a> -->
    <!-- <div><a class="btn btn-light" href="{% url 'account:login' %}">{% trans '登录' %}</a></div> -->
    {% endif %}
  </div>
</nav>
{% endblock navbar %}

{% block content %}
<!-- <hr style="margin-top: 0rem; margin-bottom: 0.5rem" /> -->
<div class="container-fluid mt-4 small">
  <div class="row">
    <div class="col-lg-12 error-msg">{{search_single.err_message}}</div>
  </div>
  <div class="row dashboard {{search_single.d_none}}">
    <div class="col-lg-4">
      <div class="col-lg-12">
        <label class="small mr-1">
          {% trans '常用指标' %}
        </label>
        <div class="btn-group btn-group-sm btn-group-toggle " data-toggle="buttons">
          <!-- <span class="mt-1 mr-1 small">{% trans '板块' %}</span> -->
          <!-- 0 - 穿越，1 - 指标值（不同period）之间比较，2 - 指标值与某一固定值，3 - 收盘价与某一指标值之间比较 -->
          <!-- 叠加主图指标 -->
          <!-- <label class="btn btn-light active small" >
            <input type="radio" name="indicator" autocomplete="off" value="MA,0,1,3" checked/>{% trans 'MA' %}
          </label> -->
          <label class="btn btn-light active " >
              <input type="radio" name="indicator" autocomplete="off" value="SMA,0,1,3" checked/>{% trans 'MA' %}
          </label>
          <label class="btn btn-light  " >
            <input type="radio" name="indicator" autocomplete="off" value="EMA,0,1,3" />{% trans 'EMA' %}
          </label>
          <label class="btn btn-light " >
            <input type="radio" name="indicator" autocomplete="off" value="BOLL,3" />{% trans 'BOLL' %}
          </label>
          <label class="btn btn-light " >
            <input type="radio" name="indicator" autocomplete="off" value="BBI,3" />{% trans 'BBI' %}
          </label>
          <!-- 动量指标 STOCH -->
          <label class="btn btn-light">
              <input type="radio" name="indicator" autocomplete="off" value="KDJ,0,1,2"/>{% trans 'KDJ' %}
          </label>
          <label class="btn btn-light">
            <input type="radio" name="indicator" autocomplete="off" value="MACD,0,1,2"/>{% trans 'MACD' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="indicator" autocomplete="off" value="RSI,2" />{% trans 'RSI' %}
          </label>
          <!-- 成交量指标 -->
          <!-- <label class="btn btn-light">
              <input type="radio" name="indicator" autocomplete="off" value="OBV,2"/>{% trans 'OBV' %}
          </label> -->
        </div>
      </div>
      <!-- <hr> -->
      <!-- Example single danger button -->

      <div class="col-lg-12 mt-2">
        <!-- <div class="small mr-1">
          {% trans '买入策略' %}
        </div> -->
        <!-- Small button groups (default and split) -->
        <div class="btn-group" id="bStrategyCategory">
          <button id="bSCPicked" class="btn btn-outline-danger btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
            {% trans '买入策略类型' %}
          </button>
          <div class="dropdown-menu small">
            <a class="dropdown-item" href="javascript:void(0);" value="0">向上/向下穿越</a>
            <a class="dropdown-item" href="javascript:void(0);" value="1">指标间比较</a>
            <a class="dropdown-item" href="javascript:void(0);" value="2">指标高低位</a>
            <a class="dropdown-item" href="javascript:void(0);" value="3">收盘价与指标</a>

          </div>
          <input type="hidden" id="hiddenStrategyCategory"/>
        </div>
        <!-- Small button groups (default and split) -->
        <div class="btn-group" id="bMenuTI1">
          <button  id="bTIPicked1" class="btn btn-outline-danger btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
            {% trans '参数1' %}
          </button>
          <div class="dropdown-menu small">
            <!-- <a class="dropdown-item" href="#">自定义</a> -->
          </div>
          <input type="hidden" id="hiddenBTI1"/>
        </div>
        <div class="btn-group" id="bMenuCond">
          <button class="btn btn-outline-danger btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" id="bCondPicked">
            {% trans '判断条件' %}
          </button>
          <div class="dropdown-menu small">
            <!-- <a class="dropdown-item" href="#">Separated link</a> -->
          </div>
          <input type="hidden" id="hiddenBCond"/>
        </div>
        <div class="btn-group" id="bMenuTI2">
          <button id="bTIPicked2" class="btn btn-outline-danger btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
            {% trans '参数2' %}
          </button>
          <div class="dropdown-menu small">
          </div>
          <input type="hidden" id="hiddenBTI2"/>
        </div>
        <button class="btn btn-primary btn-sm" type="button" id="addBStrategy">
          {% trans '+' %}
        </button>
      </div>
      <div class="col-lg-12 mt-2">
        <div class="small">
          {% trans '已选买入策略 (' %} <span id="bStrategyCount">0</span> {% trans ')' %}<span id="bMsg" class="ml-2"></span>
        </div>
        <div class="mt-1" id="bStrategyList">
        </div>
      </div>
      <!-- <hr> -->
      <div class="col-lg-12 mt-2">
        <div class="small mr-1">
        </div>
        <!-- Small button groups (default and split) -->
        <div class="btn-group" id="sStrategyCategory">
          <button id="sSCPicked" class="btn btn-outline-success btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
          {% trans '卖出策略类型' %}
          </button>
          <div class="dropdown-menu">
            <a class="dropdown-item" href="javascript:void(0);" value="0">向上/向下穿越</a>
            <a class="dropdown-item" href="javascript:void(0);" value="1">指标间比较</a>
            <a class="dropdown-item" href="javascript:void(0);" value="2">指标高低位</a>
            <a class="dropdown-item" href="javascript:void(0);" value="3">收盘价与指标</a>
          </div>
          <input type="hidden" id="hiddenSStrategyCategory"/>
        </div>
        <!-- Small button groups (default and split) -->
        <div class="btn-group" id="sMenuTI1">
          <button  id="sTIPicked1" class="btn btn-outline-success btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
            {% trans '参数1' %}
          </button>
          <div class="dropdown-menu">
          </div>
          <input type="hidden" id="hiddenSTI1"/>

        </div>
        <div class="btn-group" id="sMenuCond">
          <button class="btn btn-outline-success btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false" id="sCondPicked">
            {% trans '判断条件' %}
          </button>
          <div class="dropdown-menu">
            <!-- <a class="dropdown-item" href="#">Separated link</a> -->
          </div>
          <input type="hidden" id="hiddenSCond"/>
        </div>
        <div class="btn-group" id="sMenuTI2">
          <button id="sTIPicked2" class="btn btn-outline-success btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="false">
            {% trans '参数2' %}
          </button>
          <div class="dropdown-menu">
          </div>
          <input type="hidden" id="hiddenSTI2"/>
        </div>
        <button class="btn btn-primary btn-sm" type="button" id="addSStrategy">
          +
        </button>
      </div>
      <div class="col-lg-12 mt-2">
        <div class="small">
          {% trans '已选卖出策略 (' %} <span id="sStrategyCount">0</span> {% trans ')' %}<span id="sMsg" class="ml-2"></span>
        </div>
        <div class="mt-1" id="sStrategyList">
        </div>
      </div>

      <hr>
      <!-- <div class="col-lg-12">
        <label class="small mr-1">
          {% trans '投入资金' %}
        </label>
        
        <input type="text" class="form-control form-control-sm me-sm-2" id="cash" autocomplete="off" name="cash" placeholder="{% trans '投入资金' %}" value="10,000">
        
      </div> -->
      <div class="col-lg-12 input-group input-group-sm  mb-2 small">
        <div class="input-group-prepend"><span class="input-group-text">￥</span></div>
        <input id="capital" type="number" step="1000" class="form-control" placeholder="{% trans '投入资金' %}" aria-label="Amount (to the nearest dollar)">
        <!-- <span class="input-group-text small">.00</span> -->
        <div class="btn-group btn-group-sm btn-group-toggle ml-1" data-toggle="buttons">
          <!-- <span class="mt-1 mr-1 small">{% trans '板块' %}</span> -->
          
          <label class="btn btn-light">
              <input type="radio" name="capital-option" autocomplete="off" value="30000"/>{% trans '30,000' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="capital-option" autocomplete="off" value="50000"/>{% trans '50,000' %}
          </label>
          <label class="btn btn-light">
            <input type="radio" name="capital-option" autocomplete="off" value="100000"/>{% trans '100,000' %}
          </label>
        </div>
      </div>
      <div class="col-lg-12 input-group input-group-sm  mb-3 small">
        <div class="input-group-prepend"><span class="input-group-text">%</span></div>
        <input id="stoploss" type="number" step="1" class="form-control" placeholder="{% trans '止损比率' %}" aria-label="Amount (to the nearest dollar)">
        <!-- <span class="input-group-text small">.00</span> -->
        <div class="col-lg-6 btn-group btn-group-sm btn-group-toggle ml-1" data-toggle="buttons">
          <!-- <span class="mt-1 mr-1 small">{% trans '板块' %}</span> -->
          <label class="btn btn-light">
              <input type="radio" name="sl-option" autocomplete="off" value="3"/>{% trans '3' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="sl-option" autocomplete="off" value="5"/>{% trans '5' %}
          </label>
          <label class="btn btn-light">
            <input type="radio" name="sl-option" autocomplete="off" value="10"/>{% trans '10' %}
          </label>
          <label class="btn btn-light">
            <input type="radio" name="sl-option" autocomplete="off" value="15"/>{% trans '15' %}
          </label>
          <label class="btn btn-light">
            <input type="radio" name="sl-option" autocomplete="off" value="20"/>{% trans '20' %}
          </label>
        </div>
      </div>
      <div class="col-lg-12 mt-1">
        <label class="small mr-1">
          {% trans '交易佣金' %}
        </label>
        <div class="btn-group btn-group-sm btn-group-toggle " data-toggle="buttons">
          <!-- <span class="mt-1 mr-1 small">{% trans '板块' %}</span> -->
          
          <label class="btn btn-light active small">
              <input type="radio" name="commission-unit" autocomplete="off" value="tth" checked/>{% trans '万分之' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="commission-unit" autocomplete="off" value="th"/>{% trans '千分之' %}
          </label>
        </div>
        <div class="btn-group btn-group-sm btn-group-toggle " data-toggle="buttons">
          <!-- <span class="mt-1 mr-1 small">{% trans '板块' %}</span> -->
          <label class="btn btn-light">
              <input type="radio" name="commission" autocomplete="off" value="1"/>{% trans '1' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="commission" autocomplete="off" value="2"/>{% trans '2' %}
          </label>
          <label class="btn btn-light active">
              <input type="radio" name="commission" autocomplete="off" value="3" checked/>{% trans '3' %}
          </label>
          <label class="btn btn-light">
            <input type="radio" name="commission" autocomplete="off" value="4"/>{% trans '4' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="commission" autocomplete="off" value="5" />{% trans '5' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="commission" autocomplete="off" value="6" />{% trans '6' %}
          </label>
          <label class="btn btn-light">
            <input type="radio" name="commission" autocomplete="off" value="7"/>{% trans '7' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="commission" autocomplete="off" value="8" />{% trans '8' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="commission" autocomplete="off" value="9" />{% trans '9' %}
          </label>
        </div>
      </div>
      <!-- <div class="col-lg-12">
        <label class="small mr-1">
          {% trans '交易方式' %}
        </label>
        <div class="btn-group btn-group-sm btn-group-toggle " data-toggle="buttons">
          <label class="btn btn-light active small">
              <input type="radio" name="board" autocomplete="off" value="SMA" checked/>{% trans 'T+0' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="board" autocomplete="off" value="KDJ"/>{% trans 'T+1' %}
          </label>
        </div>
      </div> -->
      <!-- <div class="col-lg-12">
        <label class="small mr-1">
          {% trans '双向操作' %}
        </label>
        <div class="btn-group btn-group-sm btn-group-toggle " data-toggle="buttons">
          <label class="btn btn-light active small">
              <input type="radio" name="bi-direction" autocomplete="off" value="single" checked/>{% trans '不可做空' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="bi-direction" autocomplete="off" value="bi"/>{% trans '可做空' %}
          </label>
        </div>
      </div> -->
      <div class="col-lg-12 mt-1">
        <label class="small mr-1">
          {% trans '买入时点' %}
        </label>
        <div class="btn-group btn-group-sm btn-group-toggle " data-toggle="buttons">
          <label class="btn btn-light active small">
              <input type="radio" name="trade-on-close" autocomplete="off" value="0" checked/>{% trans '隔日开盘价买入' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="trade-on-close" autocomplete="off" value="1"/>{% trans '当日收盘买入' %}
          </label>
        </div>
      </div>
      <div class="col-lg-12 mt-1">
        <label class="small mr-1">
          {% trans '复权方式' %}
        </label>
        <div class="btn-group btn-group-sm btn-group-toggle " data-toggle="buttons">
          <label class="btn btn-light active">
            <input type="radio" name="restoration" autocomplete="off" value="bfq" checked/>{% trans '不复权' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="restoration" autocomplete="off" value="qfq" />{% trans '前复权' %}
          </label>
        </div>
      </div>
      <div class="col-lg-12 mt-1">
        <label class="small mr-1">
          {% trans '应用周期' %}
        </label>
        <div class="btn-group btn-group-sm btn-group-toggle " data-toggle="buttons">
          <!-- <span class="mt-1 mr-1 small">{% trans '板块' %}</span> -->
          
          <label class="btn btn-light active small">
              <input type="radio" name="freq" autocomplete="off" value="D" checked/>{% trans '日线' %}
          </label>
          <label class="btn btn-light">
              <input type="radio" name="freq" autocomplete="off" value="W"/>{% trans '周线' %}
          </label>
          <label class="btn btn-light">
            <input type="radio" name="freq" autocomplete="off" value="M"/>{% trans '月线' %}
        </label>
        </div>
      </div>
      <div class="col-lg-12 strategy-list mt-1">
        <div class="text-white mt-1">
          <button class="btn btn-primary btn-sm" type="button" id="executeBT">
            执行回测
          </button>
        </div>
      </div>
    </div>
    <div class="col-lg-8">
      <div class="row">
          <div class="col-lg-12">
              <div class="">
                <!--  Header - Dropdown -->
                <div class="d-flex flex-row align-items-center justify-content-between">
                    <h6 class="font-weight-bold text-muted"><span class="stock_name ml-2"></span></h6>
                    <hr/>
                    <div class="btn-group btn-group-sm btn-group-toggle small" data-toggle="buttons">
                        <label class="btn btn-light active">
                            <input type="radio" name="period" autocomplete="off" value="1" checked>{% trans '1年' %} 
                        </label>
                        <label class="btn btn-light">
                            <input type="radio" name="period" autocomplete="off" value="3">{% trans '3年' %} 
                        </label>
                        <label class="btn btn-light">
                            <input type="radio" name="period" autocomplete="off" value="5">{% trans '5年' %} 
                        </label>
                        <label class="btn btn-light">
                            <input type="radio" name="period" autocomplete="off" value="10">{% trans '10年' %} 
                        </label>
                        <label class="btn btn-light">
                            <input type="radio" name="period" autocomplete="off" value="99">{% trans '全部' %} 
                        </label>
                    </div>
                    <div class="btn-group btn-group-sm btn-group-toggle small" data-toggle="buttons">
                      <label class="btn btn-light active">
                          <input type="radio" name="freq" autocomplete="off" value="D" checked>{% trans '日' %} 
                      </label>
                      <label class="btn btn-light">
                          <input type="radio" name="freq" autocomplete="off" value="W">{% trans '周' %} 
                      </label>
                      <label class="btn btn-light">
                          <input type="radio" name="freq" autocomplete="off" value="M">{% trans '月' %} 
                      </label>
                      </label>
                    </div>
                </div>
                <div class="col-lg-12 mt-2 mb-2">
                    <!-- <div class="">
                      <div id="equityChart" style="height: 200px"></div>
                    </div>
                    <div class="">
                      <div id="pnlChart" style="height: 150px"></div>
                    </div> -->
                    <div class="col-lg-12">
                      <div id="btMixChart" style="height: 1800px"></div>
                    </div>
                    <!-- <div class="col-lg-12">
                      <div id="indicChart" style="height: 150px"></div>
                    </div> -->
                </div>
            </div>
          </div>
      </div>
    </div>
  </div>
</div>
<input type="hidden" id="hiddenTsCode" value="000001.SZ" name="平安银行"/>

{% endblock content %} 

{% block javascript %} {{ block.super }}
<script type="text/javascript" charset="utf-8">
  var imgRoot = "{% static 'img/' %}";
</script>
<!-- <script src="{% static 'js/common.js' %}"></script> -->
<!-- <script src="https://pagecdn.io/lib/mathjs/10.4.0/math.min.js"></script> -->
<script src="https://unpkg.com/mathjs@11.3.2/lib/browser/math.js"></script>
<script
  src="{% static 'js/backtesting.js' %}"
  type="text/javascript"
></script>
{% endblock javascript %}
